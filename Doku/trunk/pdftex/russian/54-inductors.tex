\section{Измерение индуктивностей }
Измерение величины индуктивности будет проведено, если  элемент определён как резистор сопротивлением 
ниже \(2100~\Omega\).
Метод измерения основан на росте тока по формуле:

\(Il~=~Imax~\cdot~(1~-~\exp{\frac{-t}{\tau}})\) 
после включения тока. Постоянная  времени \(\tau = \frac{L}{R}\) прямо пропорциональна индуктивности~\(L\), и обратно пропорциональна 
сопротивлению~\(R\). 
Ток может измеряться  косвенно по падению напряжения на измерительном сопротивлении.

К сожалению, постоянная  времени  будет уменьшена дополнительным, относительно высоким, сопротивлением \(680~\Omega\),
при этом измерение небольших значений индуктивности дополнительно затрудняется на частоте 8 МГц. Чтобы получить постоянную времени, напряжение на резисторе \(680~\Omega\) будет контролироваться  аналоговым компаратором. Если падение напряжения на резисторе \(680~\Omega\) будет выше, чем напряжение внутренней опоры, то это событие будет зарегистрировано 16-битным счётчиком, который запускается в момент включения тока. Счётчик сохранит состояние этого события. Если счётчик переполнится, то это будет подсчитано программой. После наступления события превышения, счётчик будет остановлен программой, и полное время состояния счетчика и счётчика переполнений будет сохранено. Положительная сторона катушки будет переключена от VCC к GND и будет оставаться в этом состоянии, пока проверка напряжения обоих выводов не покажет отсутствие тока. 
Рисунок~\ref{fig:Inductance} показывает упрощенную схему измерения индуктивности.
\begin{figure}[H]
\centering
\includegraphics[]{../FIG/Inductance.eps}
\caption{Измерение индуктивности с компаратором}
\label{fig:Inductance}
\end{figure}

Вычисляем максимальный ток Imax, как отношение напряжения VCC к сумме всех резисторов в электрической цепи, и отношение опорного напряжения к максимальному напряжению на резисторе \(680~\Omega\), которое, в свою очередь, вычисляется 
по формуле \(Umax~=~Imax~\cdot~(680~+~19)\).
Индуктивность вычисляем по формуле \(L~=~-\frac{t~\cdot~Rges}{\log{(1~-~\frac{Uref}{Umax})}}\) .the inductance can be calculated.
Натуральный логарифм берут из таблицы. Для этого типа измерения выбрано разрешение индуктивности 0.1mH.

Если величина сопротивления индуктивности будет менее \(24 \Omega\), то для того, чтобы измерить более низкие значения индуктивности, в цепи тока не будет использоваться  резистор  \(680 \Omega\). Для измерения тока будет использоваться только выходное сопротивление 
порта (\(19 \Omega\)). В этом случае пиковый ток будет больше, чем допустимое значение для ATmega . Поскольку это будет только в течение очень короткого промежутка времени, я не ожидаю повреждения портов ATmega. Для этого типа измерения выбрано разрешение индуктивности 0.01 mH. Чтобы избежать более длительного времени с чрезмерным током, дополнительное измерение с задержанным запуском счётчика будет всегда проводиться с резистором  \(680 \Omega\). Чтобы получить более подходящие результаты измерения, смещение нуля 6 вычитают из счётчика, если измерение сделано без резистора  \(680 \Omega\). Иначе вычитается смещение нуля 7 или 8.

При больших значениях индуктивности, паразитная ёмкость может вызвать быстрый рост тока, так, что компаратор срабатывает немедленно. Чтобы в этом случае получить значение индуктивности, измерение будет повторено с задержанным запуском счётчика. Этим методом аналоговым компаратором будет обнаружено напряжение, вызванное увеличением тока индуктивности, вместо напряжения от пика тока паразитной ёмкости. Измерения всегда делаются в обоих направлениях тока. Программа выберет более высокий результат измерения в том же самом направлении тока, а на дисплей будет выведен более низкий результат различных направлений тока.



\subsection{Результаты измерений индуктивности}
Рисунок~\ref{fig:Induct328p} показывает результаты измерения различных катушек.
Катушки выше  \(1 H\) - реле или первичные обмотки силовых трансформаторов затрудняют измерения, потому что у железного сердечника есть остаточное намагничивание.

\begin{figure}[H]
\centering
\input{../GNU/induct328p}
\caption{Погрешность измерения индуктивности для 15-ти различных ATmega}
\label{fig:Induct328p}
\end{figure}

