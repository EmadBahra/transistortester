%\newpage
\section{Messung von Halbleitern}
Ein Testpin wird als negative Seite des Bauteils angenommen.
Ein anderer Pin wird als positive Seite des Bauteils angenommen.
Als erster Test wird die positive Seite des Bauteils direkt mit VCC verbunden.
Die negative Seite wird mit dem \(680\Omega\) Widerstand nach GND verbunden.
Der Testpin (dritter Pin, auch TriStatePin genannt) wird zuerst mit dem \(680\Omega\)-Widerstand
für 10ms mit GND verbunden.
Die Spannung des negativen Testpins wird gemessen, während der TriStatePin auf Eingang
geschaltet ist.
Es wird angenommen, dass das getestete Bauteil ein P-Kanal-MOSFET sein kann und dass das Gate
entladen sein sollte.
Wenn die gemessene Spannung über 976mV ist, nimmt der nächste Test an. dass das getestete
Bauteil auch ein P-Kanal-MOSFET sein könnte und dafür wird der \(680\Omega\) Widerstand
für 10ms zur VCC-Seite geschaltet.
Auch für diesen Fall wird die Spannung des negativen Pins mit stromlosen TriStatePin gemessen.
Wenn die Spannung des negativen Pins grösser als 455mV ist, werden zusätzliche Tests gemacht, 
um N-Kanal JFET oder D-MOSFET (Verarmungs-Typ) und P-Kanal JFET oder P-MOSFET zu unterscheiden.
Die MOSFET-Versionen können erkannt werden durch das Fehlen von Steuerstrom in jedem 
TriStatePins Zustand.

Um Parameter der Verarmungstypen messen zu können, werden sie mit einem \(680 \Omega\)-Widerstand am
Source-Pin vermessen, wie in Abbildung \ref{fig:JFETcd} gezeigt wird. Diese Messung wird anstelle der
üblichen Messung des Stromes bei einer Gate-Spannung auf Source-Potential gemacht, da wegen des
relativ hohen \(680 \Omega\) Widerstandes in vielen Fällen der Kennstrom \(I_\mathrm{DSS}\) 
des FETs nicht erreicht würde.

\begin{figure}[H]
\centering
\includegraphics[]{../FIG/JFETcd.eps}
\caption{Messung von Gate-Source-Spannung und Source-Strom eines N-JFET-Transistors}
\label{fig:JFETcd}
\end{figure}

Wenn das Bauteil keinen Strom zwischen dem positiven Pin und dem negativen Pin ohne ein Signal
auf dem TristatePin hat, sind die nächsten Tests im nächsten Unterkapitel \ref{sec:pnp} beschrieben.
Wenn Strom festgestellt wird, sind die nächsten Tests in dem Dioden-Unterkapitel \ref{sec:diode} beschrieben.

\subsection{Messung eines PNP-Transistors oder eines P-Kanal MOSFETs}
\label{sec:pnp}
Zuerst wird der Stromverstärkungsfaktor in der Kollektor-Schaltung (Emitter-Folger) für den angenommenen
PNP-Transistor gemessen.
Die Messsituation wird in Abbildung \ref{fig:pnpcc} gezeigt.
Wenn die gemessene Basis-Spannung (\(UB\)) über 9mV mit dem \(680\Omega\) Widerstand liegt,
wird die Stromverstärkung hFE berechnet mit \(hFE = \frac{UE-UB}{UB}\). 
Die Spannung \(UE\) ist die Differenz der Emitter-Spannung zu VCC.
Die Differenz des \(22\Omega\) und \(19\Omega\)-Widerstandes wird nicht berücksichtigt.
Wenn die Spannung \(UB\) unter 10mV liegt, wird die Messung mit dem \(470k\Omega\)-Widerstand an der Basis gemacht.
Für diesen Fall wird der Stromverstärkungsfaktor mit \(hFE = \frac{UE \cdot 470000}{UB \cdot (680+22)}\) gebildet.

\begin{figure}[H]
\centering
\includegraphics[]{../FIG/PNPcc.eps}
\caption{hFE-Messung eines PNP-Transistors in Kollektor-Schaltung}
\label{fig:pnpcc}
\end{figure}

Als Nächstes werden die Tests in Emitter-Schaltung für den angenommenen PNP-Transistor gemacht.
Die positive Seite wird jetzt direkt mit VCC verbunden, der \(680\Omega\)-Widerstand der negativen Seite wird 
mit GND verbunden, wie es in Abbildung \ref{fig:pnpce} gezeigt wird. 
Wenn die negative Seite des Bauteils eine Spannung über 3,4V hat, wenn der \(680\Omega\)-Widerstand auf der Basis-Seite mit
GND verbunden ist, muss es ein PNP-Transistor oder ein P-Kanal-FET sein.
Das kann einfach unterschieden werden durch Prüfen der Basis-Spannung: Wenn sie grösser als 0,97V ist, muss es ein PNP sein.
Für die Messung des Stromverstärkungsfaktors wird anstelle des \(680\Omega\)-Widerstandes der
 \(470k\Omega\)-Widerstand als Basis-Widerstand genommen.
Der Stromverstärkungsfaktor wird berechnet mit \(hFE = \frac{(UC-UC0) \cdot 470000}{UB \cdot (680+19)}\) .
Die Spannung UC0 ist die Spannung am Kollektorwiderstand ohne Basisstrom.
Der höhere Stromverstärkungsfaktor wird als der richtige angenommen, dieser hier oder der
mit der Kollektor-Schaltung bestimmte.
Ab der Softwareversion 1.08k wird der Stromverstärkungsfaktor in der Emitterschaltung nur für Prozessoren mit mehr
als 16k Flash Speicher wie dem ATmega328 gebildet. Für andere Prozessoren wird nur die Kollektorschaltung benutzt.


Die Werte, die für den PNP-Transistor herausgefunden wurden, sind nur gültig, wenn ein zweiter Satz
von Messungen gemacht wurde.
Um zu verhindern, dass der PNP-Transistor in der inversen Schaltung (Kollektor und Emitter vertauscht) erkannt
wird, wird dann die Messung mit dem höheren Stromverstärkungsfaktor als richtige Messung genommen.
Wenn die Basis-Spannung kleiner als 0,97V ist, muss es ein P-E-MOS sein.
In diesem Fall wird die Gate-Schwellwertspannung dadurch bestimmt, dass die Spannung am Gate langsam mit dem
 \(470k\Omega\)-Widerstand rauf und runter gezogen wird bis die Drain-Seite schaltet und dann
die Spannung am Gate gemessen wird.

\begin{figure}[H]
\centering
\includegraphics[]{../FIG/PNPce.eps}
\caption{Prüfung und hFE-Messung eines PNP-Transistors in der Emitter-Schaltung}
\label{fig:pnpce}
\end{figure}

\subsection{Messung eines NPN-Transistors oder eines N-Kanal-MOSFET}
Die Messung eines NPN-Transistors beginnt auf gleiche Weise wie die PNP-Transistor-Messung, nämlich
mit der Messung des Stromverstärkungsfaktors in der Kollektor-Schaltung.
Zuerst wird die Messung mit einem nach VCC geschalteten \(680\Omega\)-Basiswiderstand gemacht.
Wenn die Spannung am Basis-Widerstand zu klein ist, wird stattdessen der \(470k\Omega\)-Widerstand genommen.
Die Messungen werden dann in der Emitter-Schaltung fortgeführt, wie in Abbildung \ref{fig:npnce} gezeigt.
\begin{figure}[H]
\centering
\includegraphics[]{../FIG/NPNce.eps}
\caption{Prüfung und hFE-Messung eines NPN-Transistors in Emitter-Schaltung}
\label{fig:npnce}
\end{figure}
Wenn die Spannung auf der Kollektor Seite unter 1,6V liegt, während der \(680\Omega\)-Basiswiderstand mit
VCC verbunden ist, muss es ein NPN, ein N-Kanal MOSFET oder ein Thyristor (TRIAC) sein.
Mit zwei einfachen Tests kann ein Thyristor oder Triac erkannt werden.
Wenn der Gate-Pin für 10ms mit GND verbunden wird und dann stromlos geschaltet wird, sollte
der Strom an der Anode bleiben.
Wenn jetzt der Anoden-Widerstand kurz auf GND geschaltet und dann auf VCC zurückgeschaltet wird,
sollte der Thyristor nicht erneut zünden (stromlos bleiben).
Beachten Sie, dass nur Kleinleistungs Thyristoren getestet werden können, weil der Haltestrom des
Testers nur 6mA erreichen kann.
Wenn beide Tests einen Thyristor bestätigen, werden weitere Tests in umgekehrter Polarität gemacht,
um ein TRIAC auszuschliessen oder zu bestätigen.

Wenn weder Thyristor noch TRIAC bestätigt wurden, kann es ein NPN oder ein N-Kanal E-MOSFET sein.
Die Basis-Spannung von einem NPN-Transistor wird nahe bei der Emitter-Spannung liegen, so dass dieser Typ sicher
erkannt werden kann.
Der Stromverstärkungsfaktor in der Emitter-Schaltung wird durch \(hFE = \frac{(VCC-UC-UC0)\cdot 470000}{(VCC-UB)\cdot (680+22)}\) 
gebildet.
Wenn die Spannung an der Basis zeigt, dass kein oder wenig Strom fließt, wird das Bauteil ein N-Kanal E-MOS
(Anreicherungs-MOSFET) sein. In diesem Fall wird die Schwellspannung gemessen, indem die Spannung des Gates langsam mit
dem \(470k\Omega\)-Widerstand nach VCC und GND gezogen wird, darauf wartend, dass das digitale
Eingangs-Signal auf der Drain Seite schaltet, wobei dann die Gate-Spannung gelesen wird.
Die Messung wird elf Mal wiederholt wie in Abbildung~\ref{fig:eleven} gezeigt und die Ergebnisse addiert.
Diese Summe wird mit vier multipliziert und durch neun geteilt um eine Auflösung in mV zu erhalten.
\begin{figure}[H]
\centering
\includegraphics[]{../PNG/IRFU120gate.png}
\caption{Messung der Schwellspannung eines N-Kanal-MOSFET}
\label{fig:eleven}
\end{figure}

\subsection{Messung von Dioden}
\label{sec:diode}
Wenn Strom bei den Vortests festgestellt wurde, wird das Bauteil auf Diodenverhalten geprüft.
Die Flussspannung mit dem \(680\Omega\)-Widerstand muss zwischen 0,15V und 4,64V liegen.
Die Flussspannung mit dem \(680\Omega\)-Widerstand muss grösser als 1,125 Mal der Flussspannung mit dem
 \(470k\Omega\)-Widerstand sein und sechzehn Mal die Flussspannung mit dem \(470k\Omega\)-Widerstand muss
grösser als die Flussspannung mit dem \(680\Omega\)-Widerstand sein.
Ich hoffe, dass ein Bauteil mit diesem Verhalten immer eine Diode ist.
Die Erkennung des Diodenverhaltens durch den fehlenden Stromfluß in der Gegenrichtung ist nicht
möglich bei antiparallelen Dioden.
Bei einer Einzeldiode wird zusätzlich der Sperrstrom der Diode bei 5V mit dem \(470k\Omega\) Widerstand
gemessen. Die Auflösung beträgt etwa \(2nA\). Bei größeren Restströmen als \(5.3\mu A\) (Spannung am Widerstand größer als 2.5V) wird
 mit dem \(680\Omega\) Widerstand gemessen. Dann beträgt die Auflösung nur etwa \(1\mu A\).
Außerdem wird bei Einzeldioden eine Kapazitätsmessung in Sperr-Richtung durchgeführt. 

\subsection{Ergebnisse der verschiedenen Messungen}
Die folgenden drei Tabelle zeigen die Ergebnisse verschiedener Bauteile 
eines ATmega8-Prozessors und verschiedenen Softwareversionen eines ATmega168-Prozessoren.
Die Messung der Sperrschichtkapazität für die Doppeldiode MBR4045PT gelingt
nur gekühlt. Die Ursache hierfür ist der hohe Reststrom der 40A Diode. Ebenso kann für die Basis - Emitter
Strecke des Germanium Transistors AC128 die Sperrschichtkapazität nur im
gekühlten Zustand gemessen werden. 

\begin{table}[H]
  \begin{center}
    \begin{tabular}{| l | c | c | c |}
    \hline
     Diode & Mega8@8MHz          & Mega168 @8MHz       & Mega168 @8MHz     \\
     Type  & Signatur 1E9307     & Signatur 1E9406     & Signatur 1E9406   \\
           & WITH\_AUTO\_REF     &                     & AUTO\_CAL         \\
           &                     &                     & AUTOSCALE\_ADC    \\
    \hline
    \hline
1N4148     & Diode, 715mV, 1pF    & Diode, 721mV, 0pF   & Diode, 714mV, 0pF  \\
    \hline
1N4150     & Diode, 665mV, 1pF    & Diode, 672mV, 1pF   & Diode, 667V, 0pF  \\
    \hline
BA157      & Diode, 619mV, 19pF   & Diode, 625V, 20pF   & Diode, 620mV, 18pF \\
    \hline
BY398      & Diode, 538mV, 16pF   & Diode, 541mV, 16pF  & Diode, 541mV, 15pF \\
    \hline
1N4007     & Diode, 650mV, 13pF   & Diode, 660mV, 13pF  & Diode, 655mV, 10pF \\
    \hline
LED green  & Diode, 1.96V, 5pF    & Diode, 1.95V, 6pF   & Diode, 1.95V, 4pF \\
    \hline
ZPD2,7     & 2xDi, 743mV, 2.53V   & 2xDi, 743mV, 2.53V  & 2xDi, 736V, 2.52V \\
    \hline
BU508A B+E & Diode, 609mV, 5.15nF & Diode, 614mV, 5.30nF & Diode, 609mV, 5.28nF\\
    \hline
BU508A B+C & Diode, 582mV, 256pF  & Diode, 589mV, 264pF & Diode, 587mV, 260pF\\
    \hline
AC128 B+E  & Diode, 272mV, 0pF    & Diode, 277mV, 0pF   & Diode, 273mV, 0pF  \\
    \hline
AC128 B+E  &                      &    gekühlt          & Diode, 349mV, 140pF  \\
    \hline
MBR20100CT & 2xDi, 337mV, 337mV   & 2xDi, 341mV, 341mV  & 2xDi, 340mV, 338mV  \\
    \hline
MBR20100CT & Diode, 337mV, 345pF  & Diode, 341mV, 360pF & Diode, 338mV, 354pF\\
    \hline
MBR4045PT  & Diode, 243mV, 1.80nF & Diode, 239mV, 1.98nF & Diode, 235mV, 1.95nF\\
gekühlt    &                      &                     &                   \\
    \hline
SF38G      & Diode, 519mV, 107pF  & Diode, 523mV, 108pF & Diode, 521mV, 108pF\\
    \hline
    \end{tabular}
  \end{center}
  \caption{Messergebnisse der Dioden-Tests}
  \label{tab:diodes} 
\end{table}

\begin{table}[H]
  \begin{center}
    \begin{tabular}{| l | c | c | c |}
    \hline
 Transistor & Mega8@8MHz          & Mega168 @8MHz       & Mega168 @8MHz    \\
    Type    & Signatur 1E9307     & Signatur 1E9406     & Signatur 1E9406  \\
            & WITH\_AUTO\_REF     &                     & AUTO\_CAL        \\
            &                     &                     & AUTOSCALE\_ADC   \\
    \hline
    \hline
BU508A      & NPN, B=9, 602mV     & NPN, B=9, 599mV     & NPN, B=9, 599mV   \\
    \hline
2N3055      & NPN, B=20, 553mV    & NPN, B=21, 551mV    & NPN, B=21, 551mV  \\
    \hline
BC639       & NPN, B=180, 628mV   & NPN, B=215, 633mV   & NPN, B=215, 630mV \\
    \hline
BC640       & PNP, B=216, 635mV   & PNP, B=226, 639mV   & PNP, B=180, 604mV \\
    \hline
BC517       & NPN, B=26.1k, 1.20V & NPN, B=25.7k, 1.21V & NPN, B=26.2k, 1.22V\\
    \hline
BC516       & PNP, B=77.6k, 1.20V & PNP, B=78.7k, 1.19V & PNP, B=76.3k, 1.19V\\
    \hline
BC546B      & NPN, B=381, 659mV   & NPN, B=428, 686mV   & NPN, B=428, 687mV \\
    \hline
BC556B      & PNP, B=285, 689mV   & PNP, B=426, 696mV   & PNP, B=258, 667mV \\
    \hline
AC128 (Ge.) & PNP, B=63, 190mV    & PNP, B=63, 190mV    & PNP, B=59, 189mV  \\
    \hline
BRY55/200   & Thyristor           & Thyristor           & Thyristor        \\
    \hline
MAC97A6     & Triac               & Triac               & Triac        \\
    \hline
    \end{tabular}
  \end{center}
  \caption{Messergebnisse der Tests mit bipolaren Transistoren}
  \label{tab:bipolar} 
\end{table}

Die Ergebnisse unterscheiden sich teilweise erheblich von den Werten der Version 
von Markus Frejek. Zum Beispiel wird für den Darlington Transistor BC517 von
der früheren Software ein hFE von nur 797 statt 77600 gemessen. 
Dies hängt damit zusammen, dass die Stromverstärkung bei der neuen Version auch mit der
Kollektorschaltung gemessen wird.
Die Basis Emitter Spannung wurde früher mit einem separaten Diodentest mit 1438mV ermittelt.
Jetzt wird die angegebene Basis Emitter Spannung im Zustand der Verstärkungsmessung (1.20V) ermittelt.

\begin{table}[H]
  \begin{center}
    \begin{tabular}{| l | c | c | c |}
    \hline
     FET     & Mega8@8MHz       & Mega168 @8MHz    & Mega168 @8MHz \\
    Type     & Signatur 1E9307  & Signatur 1E9406  & Signatur 1E9406 \\
             & WITH\_AUTO\_REF  &                  & AUTO\_CAL \\
             &                  &                  & AUTOSCALE\_ADC \\
    \hline
    \hline
ZVNL120A     & N-E-MOS,D, 1.5V  & N-E-MOS,D, 1.5V  & N-E-MOS,D, 1.5V \\
             & 142pF            & 146pF            & 141pF \\
    \hline
IRF530N      & N-E-MOS,D, 3.6V  & N-E-MOS,D, 3.6V  & N-E-MOS,D, 3.6V \\
             & 1.55nF           & 1.56nF           & 1.55nF \\
    \hline
BS170        & N-E-MOS,D, 2.6V  & N-E-MOS,D, 2.6V  & N-E-MOS,D, 2.6V \\
             &  71pF            &  73pF            &  70pF \\
    \hline
IRL3803      & N-E-MOS,D, 2.3V  & N-E-MOS,D, 2.3V  & N-E-MOS,D, 2.3V \\
             & 9.82nF           & 9.82nF           & 9.79nF \\
    \hline
IRFU120N     & N-E-MOS,D, 4.2V  & N-E-MOS,D, 4.2V  & N-E-MOS,D, 4.2V \\
             & 918pF            & 924pF            & 918pF \\
    \hline
BUZ71A       & N-E-MOS,D, 3.2V  & N-E-MOS,D, 3.2V  & N-E-MOS,D, 3.2V \\
             & 710pF            & 718pF            & 712pF \\
    \hline
ZVP2106A     & P-E-MOS,D, 3.2V  & P-E-MOS,D, 3.2V  & P-E-MOS,D, 3.2V \\
             & 117pF            & 121pF            & 116pF \\
    \hline
IRF5305      & P-E-MOS,D, 3.6V  & P-E-MOS,D, 3.6V  & P-E-MOS,D, 3.6V \\
             & 2.23nF           & 2.25nF           & 2.24nF \\
    \hline
BS250        & P-E-MOS,D, 2.6V  & P-E-MOS,D, 2.6V  & P-E-MOS,D, 2.6V \\
             & 46pF             & 48pF             & 46pF \\
    \hline
IRFU9024     & P-E-MOS,D, 3.5V  & P-E-MOS,D, 3.6V  & P-E-MOS,D, 3.5V \\
             & 954pF            & 954pF            & 951pF \\
    \hline
J310         & N-JFET           & N-JFET           & N-JFET\\
Idss=24-60mA & I=3.1mA Vgs=2.2V & I=3.1mA Vgs=2.2V & I=3.1mA Vgs=2.2V \\
    \hline
BF256C       & N-JFET           & N-JFET           & N-JFET\\
Idss=11-18mA & I=3.3mA Vgs=2.3V & I=3.4mA Vgs=2.3V & I=3.3mA Vgs=2.3V \\
    \hline
BF245A       & N-JFET           & N-JFET           & N-JFET\\
Idss=2-6mA   & I=1.1mA Vgs=.75V & I=1.1mA Vgs=0.74V & I=1.1mA Vgs=0.75V \\
    \hline
BF245B       & N-JFET           & N-JFET           & N-JFET\\
Idss=6-15mA  & I=2.4mA Vgs=1.7V & I=2.5mA Vgs=1.7V & I=2.4mA Vgs=1.7V \\
    \hline
BF245C       & N-JFET           & N-JFET           & N-JFET\\
Idss=12-25mA & I=3.8mA Vgs=2.7V & I=3.9mA Vgs=2.7V & I=3.8mA Vgs=2.7V \\
    \hline
    \end{tabular}
  \end{center}
  \caption{Messergebnisse der MOS-Transistor-Tests}
  \label{tab:mos} 
\end{table}
